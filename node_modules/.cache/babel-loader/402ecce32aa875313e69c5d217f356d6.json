{"ast":null,"code":"var _jsxFileName = \"/home/ubuntu/Documents/BC_Projects/OPPO-DS/src/components/IsAutorised.js\";\nimport React, { Component } from 'react';\nimport { createContract } from '../ethereum/DiplomaStorageContract';\nimport { Table } from 'semantic-ui-react';\nimport Web3 from 'web3';\nimport { web3 } from '../ethereum/web3';\nimport { Button, Header, Form, Checkbox } from 'semantic-ui-react';\nexport class IsAutorised extends Component {\n  async componentDidMount() {\n    this.loadBcData();\n    const contract = createContract(this.getDiplomaStorageAddress());\n    this.setState({\n      contract\n    });\n    console.log(\"contrat\", contract);\n    this.getContractState(contract);\n    await this.getStudent(this.getDiplomaStorageAddress(), this.state.id);\n  }\n\n  async getContractState(contract) {\n    this.setState({\n      loading: true\n    });\n    const master = contract.methods.master().call();\n    console.log('master');\n    const studentCount = await contract.methods.studentCount().call();\n    this.setState({\n      studentCount: studentCount\n    });\n    console.log('studentCount GCS', studentCount);\n  }\n\n  async loadBcData() {\n    const web3 = new Web3(Web3.givenProvider || \"http://localhost:8545\");\n    const network = await web3.eth.net.getNetworkType();\n    console.log(\"network\", network);\n    const accounts = await web3.eth.getAccounts();\n    console.log(\"account\", accounts[0]);\n    this.setState({\n      account: accounts[0]\n    });\n    console.log(\"addresseContrat\", this.getDiplomaStorageAddress());\n    const contract = createContract(this.getDiplomaStorageAddress());\n    this.setState({\n      contract\n    });\n    const studentCount = await this.state.contract.methods.studentCount().call();\n    this.setState({\n      studentCount: studentCount\n    });\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      id: 0,\n      address: '',\n      lv: 0\n    };\n    this.onChange = this.onChange.bind(this);\n    this.onSubmit = this.onSubmit.bind(this);\n    this.state = {\n      lv: 0\n    };\n  }\n\n  getDiplomaStorageAddress() {\n    return '0x64399f5759209029856F40854699f65e57ED4225';\n  }\n\n  async isAutorised(address, id) {\n    const contract = createContract(address);\n    this.setState({\n      contract\n    });\n    console.log(contract);\n    const lv = await contract.methods.isAutorised(id, address).call;\n    this.setState({\n      lv: lv\n    });\n    console.log(\"lv\", this.state.lv);\n  }\n\n  async onChange(event) {\n    const target = event.target;\n    const value = target.value;\n    const name = target.name;\n    await this.setState({\n      [name]: value\n    });\n    console.log(name, value, this.state);\n  }\n\n  async onSubmit(event) {\n    event.preventDefault();\n    const lv = await this.IsAutorised(this.state.id, this.state.address);\n    console.log('lvf', lv);\n    this.setState({\n      lv: lv\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 1\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 9\n      }\n    }, \"Id :\", /*#__PURE__*/React.createElement(\"input\", {\n      name: \"id\",\n      type: \"number\",\n      value: this.state.id,\n      onChange: this.onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 9\n      }\n    }, \"address :\", /*#__PURE__*/React.createElement(\"input\", {\n      name: \"address\",\n      type: \"text\",\n      value: this.state.address,\n      onChange: this.onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 11\n      }\n    }))), /*#__PURE__*/React.createElement(Button, {\n      type: \"submit\",\n      onClick: this.onSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 7\n      }\n    }, \"Submit\"), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 11\n      }\n    }, \"Account : \", this.state.account), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 11\n      }\n    }, \"ID : \", this.state.id, \" \"), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 11\n      }\n    }, \"address : \", this.state.address, \" \"), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 11\n      }\n    }, \"lv : \", this.state.lv, \" \"));\n  }\n\n}\nexport default IsAutorised;","map":{"version":3,"sources":["/home/ubuntu/Documents/BC_Projects/OPPO-DS/src/components/IsAutorised.js"],"names":["React","Component","createContract","Table","Web3","web3","Button","Header","Form","Checkbox","IsAutorised","componentDidMount","loadBcData","contract","getDiplomaStorageAddress","setState","console","log","getContractState","getStudent","state","id","loading","master","methods","call","studentCount","givenProvider","network","eth","net","getNetworkType","accounts","getAccounts","account","constructor","props","address","lv","onChange","bind","onSubmit","isAutorised","event","target","value","name","preventDefault","render"],"mappings":"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","sourcesContent":["import React, { Component }  from 'react'\nimport { createContract } from '../ethereum/DiplomaStorageContract'\nimport { Table } from 'semantic-ui-react'\nimport Web3 from 'web3'\nimport { web3 } from '../ethereum/web3'\nimport { Button, Header, Form, Checkbox} from 'semantic-ui-react';\n\n\n\n\nexport class IsAutorised extends Component {\n\n\n    state = {\n        id:0,\n        address: '',\n        lv:0,\n    }\n\n  async componentDidMount () {\n    this.loadBcData()\n    const contract = createContract(this.getDiplomaStorageAddress())\n    this.setState({contract})\n    console.log(\"contrat\",contract)\n    this.getContractState(contract)\n    await this.getStudent(this.getDiplomaStorageAddress(),this.state.id)\n  }\n\n\n  async getContractState(contract){\n    this.setState({loading:true})\n    const master = contract.methods.master().call()\n    console.log('master')\n    const studentCount = await contract.methods.studentCount().call()\n    this.setState({studentCount: studentCount})\n    console.log('studentCount GCS',studentCount)\n  }\n\n  async loadBcData(){\n    const web3 = new Web3(Web3.givenProvider || \"http://localhost:8545\")\n    const network = await web3.eth.net.getNetworkType()\n    console.log(\"network\",network)\n    const accounts = await web3.eth.getAccounts()\n    console.log(\"account\", accounts[0])\n    this.setState({account: accounts[0]})\n    console.log(\"addresseContrat\",this.getDiplomaStorageAddress())\n\n    const contract = createContract(this.getDiplomaStorageAddress())\n    this.setState({contract})\n    const studentCount = await this.state.contract.methods.studentCount().call()\n    this.setState({studentCount: studentCount})\n  }\n \n  constructor(props) {\n    super(props)\n    this.onChange = this.onChange.bind(this);\n    this.onSubmit = this.onSubmit.bind(this);\n    this.state = {\n      lv: 0,\n    }\n  }\n  \n  \n  getDiplomaStorageAddress () {\n    return '0x64399f5759209029856F40854699f65e57ED4225'\n  }\n\n  async isAutorised(address,id) {\n    const contract = createContract(address)\n\n    this.setState({ contract })\n    console.log(contract)\n\n    const lv = await contract.methods.isAutorised(id,address).call\n    this.setState({lv:lv})\n    console.log(\"lv\", this.state.lv)\n  }\n\n  \n\n\n\n  async onChange(event) {\n    \n      const target = event.target;\n      const value =  target.value;\n      const name = target.name;\n  \n      await this.setState({\n        [name]: value\n      });\n      console.log(name,value,this.state)  \n  }\n\n  \n\n\n\n    async onSubmit(event) {\n    event.preventDefault();\n    const lv = await this.IsAutorised(this.state.id,this.state.address)\n    console.log('lvf',lv) \n    this.setState({lv:lv})\n    }\n\n  render() {\n    return (\n\n      \n      \n        <div>\n\n<form>\n        <label>\n          Id :\n          <input\n            name=\"id\"\n            type=\"number\"\n            value={this.state.id}\n            onChange={this.onChange} />\n        </label>\n        <br />\n        <label>\n          address :\n          <input\n            name=\"address\"\n            type=\"text\"\n            value={this.state.address}\n            onChange={this.onChange} />\n        </label>\n       \n      </form>\n\n      <Button\n          type='submit'\n          onClick={this.onSubmit}\n          >\n          Submit\n      </Button>\n\n\n          <p>Account : {this.state.account}</p>\n          <p>ID : {this.state.id} </p>\n          <p>address : {this.state.address} </p>\n          <p>lv : {this.state.lv} </p>\n\n\n   \n          \n        </div>\n    );\n  }\n}\n\nexport default IsAutorised;"]},"metadata":{},"sourceType":"module"}