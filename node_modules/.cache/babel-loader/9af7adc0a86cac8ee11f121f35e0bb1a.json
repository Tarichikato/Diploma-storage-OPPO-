{"ast":null,"code":"var _jsxFileName = \"/home/ubuntu/Documents/BC_Projects/OPPO-DS/src/components/CreateSchool.js\";\nimport React, { Component } from 'react';\nimport { createContract } from '../ethereum/DiplomaStorageContract';\nimport { Table, Button, Form, Checkbox } from 'semantic-ui-react';\nimport Web3 from 'web3';\nimport { web3 } from '../ethereum/web3';\nexport class CreateSchool extends Component {\n  async componentDidMount() {\n    this.loadBcData();\n    const contract = createContract(this.getDiplomaStorageAddress());\n    this.setState({\n      contract\n    });\n    console.log(\"contrat\", contract);\n    this.getContractState(contract);\n  }\n\n  async getContractState(contract) {\n    this.setState({\n      loading: true\n    });\n    const master = contract.methods.master().call();\n    console.log('master');\n    const studentCount = await contract.methods.studentCount().call();\n    this.setState({\n      studentCount: studentCount\n    });\n    console.log('studentCount GCS', studentCount);\n  }\n\n  async loadBcData() {\n    const web3 = new Web3(Web3.givenProvider || \"http://localhost:8545\");\n    const network = await web3.eth.net.getNetworkType();\n    console.log(\"network\", network);\n    const accounts = await web3.eth.getAccounts();\n    console.log(\"account\", accounts[0]);\n    this.setState({\n      account: accounts[0]\n    });\n    console.log(\"addresseContrat\", this.getDiplomaStorageAddress());\n    const contract = createContract(this.getDiplomaStorageAddress());\n    this.setState({\n      contract\n    });\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      idSchool: 0,\n      address: 0,\n      schoolName: 'N/A',\n      schoolCount: 0,\n      answer: ''\n    };\n    this.onChange = this.onChange.bind(this);\n    this.onSubmit = this.onSubmit.bind(this);\n    this.state = {\n      idSchool: 0,\n      address: 0,\n      schoolName: 'N/A',\n      schoolCount: 0,\n      answer: ''\n    };\n  }\n\n  getDiplomaStorageAddress() {\n    return '0x64399f5759209029856F40854699f65e57ED4225';\n  }\n\n  async getStudent(address, id) {\n    const contract = createContract(address);\n    this.setState({\n      contract\n    });\n    console.log(contract);\n    const student = await contract.methods.students(id).call();\n    this.setState({\n      students: [student]\n    });\n    console.log(\"student\", this.state.students);\n    const studentCount = await contract.methods.studentCount().call();\n    this.setState({\n      studentCount\n    });\n  }\n\n  async createSchool(address, schoolName) {\n    this.setState({\n      loading: true\n    });\n    const contract = createContract(this.getDiplomaStorageAddress());\n    this.setState({\n      contract\n    });\n    const answer = contract.methods.createSchool(address, schoolName).send({\n      from: '0xfd9e5D7BbB1871453b772B310632245ba9bf37F8'\n    });\n    const schoolCount = await contract.methods.schoolCount().call();\n    this.setState({\n      answer: answer\n    });\n    this.setState({\n      schoolCount: schoolCount\n    });\n    console.log(\"NEW schoolCount\", schoolCount);\n  }\n\n  async onChange(event) {\n    const target = event.target;\n    const value = target.value;\n    const name = target.name;\n    console.log('OC1', name, value, this.state);\n    await this.setState({\n      [name]: value\n    });\n    console.log('OC2', name, value, this.state);\n  }\n\n  async onSubmit(event) {\n    event.preventDefault();\n    await this.createSchool(this.state.address, this.state.schoolName);\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 1\n      }\n    }, \"Account : \", this.state.account), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 1\n      }\n    }, \"SchoolCount : \", this.state.schoolCount), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 1\n      }\n    }, \"Contract address: \", this.getDiplomaStorageAddress()), /*#__PURE__*/React.createElement(\"form\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 1\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 9\n      }\n    }, \"adresse :\", /*#__PURE__*/React.createElement(\"input\", {\n      placeholder: \"Enter adresse here\",\n      name: \"adress\",\n      type: \"text\" //value={this.state.INE}\n      ,\n      onChange: this.onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 9\n      }\n    }, \"schoolName :\", /*#__PURE__*/React.createElement(\"input\", {\n      placeholder: \"School Name\",\n      name: \"schoolName\",\n      type: \"text\" //value={this.state.firstName}\n      ,\n      onChange: this.onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 11\n      }\n    }))), /*#__PURE__*/React.createElement(Button, {\n      type: \"submit\",\n      onClick: this.onSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 7\n      }\n    }, \"Submit\"), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 9\n      }\n    }, \"adress: \", this.state.adress), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 9\n      }\n    }, \"schoolName: \", this.state.schoolName));\n  }\n\n}\nexport default CreateSchool;","map":{"version":3,"sources":["/home/ubuntu/Documents/BC_Projects/OPPO-DS/src/components/CreateSchool.js"],"names":["React","Component","createContract","Table","Button","Form","Checkbox","Web3","web3","CreateSchool","componentDidMount","loadBcData","contract","getDiplomaStorageAddress","setState","console","log","getContractState","loading","master","methods","call","studentCount","givenProvider","network","eth","net","getNetworkType","accounts","getAccounts","account","constructor","props","state","idSchool","address","schoolName","schoolCount","answer","onChange","bind","onSubmit","getStudent","id","student","students","createSchool","send","from","event","target","value","name","preventDefault","render","adress"],"mappings":"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","sourcesContent":["import React, { Component }  from 'react'\nimport { createContract } from '../ethereum/DiplomaStorageContract'\nimport { Table, Button,Form,Checkbox } from 'semantic-ui-react'\nimport Web3 from 'web3'\nimport { web3 } from '../ethereum/web3'\n\n\n\nexport class CreateSchool extends Component {\n\n    state = {\n       \n            idSchool: 0,\n            address: 0,\n            schoolName: 'N/A',\n            schoolCount: 0,\n            answer: '',\n        \n\n    }\n\n  async componentDidMount () {\n    this.loadBcData()\n    const contract = createContract(this.getDiplomaStorageAddress())\n    this.setState({contract})\n    console.log(\"contrat\",contract)\n    this.getContractState(contract)\n  }\n\n\n  async getContractState(contract){\n    this.setState({loading:true})\n    const master = contract.methods.master().call()\n    console.log('master')\n    const studentCount = await contract.methods.studentCount().call()\n    this.setState({studentCount: studentCount})\n    console.log('studentCount GCS',studentCount)\n  }\n\n  async loadBcData(){\n    const web3 = new Web3(Web3.givenProvider || \"http://localhost:8545\")\n    const network = await web3.eth.net.getNetworkType()\n    console.log(\"network\",network)\n    const accounts = await web3.eth.getAccounts()\n    console.log(\"account\", accounts[0])\n    this.setState({account: accounts[0]})\n    console.log(\"addresseContrat\",this.getDiplomaStorageAddress())\n\n    const contract = createContract(this.getDiplomaStorageAddress())\n    this.setState({contract})\n  }\n \n  constructor(props) {\n    super(props)\n    this.onChange = this.onChange.bind(this);\n    this.onSubmit = this.onSubmit.bind(this);\n    this.state = {\n      \n      idSchool: 0,\n      address: 0,\n      schoolName: 'N/A',   \n      schoolCount: 0,\n      answer: '',\n    }\n  }\n  \n  \n  getDiplomaStorageAddress () {\n    return '0x64399f5759209029856F40854699f65e57ED4225'\n  }\n\n  async getStudent(address,id) {\n      \n    const contract = createContract(address)\n    this.setState({ contract })\n    console.log(contract)\n\n    const student = await contract.methods.students(id).call()\n    this.setState({\n        students: [student]\n    })\n    console.log(\"student\", this.state.students)\n\n    const studentCount = await contract.methods.studentCount().call()\n    this.setState({studentCount})\n  }\n\n  \n\n\n   async createSchool(address,schoolName) {\n    this.setState({loading:true})\n    const contract = createContract(this.getDiplomaStorageAddress())\n    this.setState({contract})\n    const answer = contract.methods.createSchool(address,schoolName).send({ from: '0xfd9e5D7BbB1871453b772B310632245ba9bf37F8' })\n    const schoolCount = await contract.methods.schoolCount().call()\n    this.setState({answer : answer})\n    this.setState({schoolCount: schoolCount})\n    console.log(\"NEW schoolCount\",schoolCount)\n  } \n\n  async onChange(event) {\n    \n    const target = event.target;\n    const value =  target.value;\n    const name = target.name;\n    console.log('OC1',name,value,this.state) \n    await this.setState({\n      [name]: value\n    });\n    console.log('OC2',name,value,this.state)  \n}\n\n\n\n\n\n  async onSubmit(event) {\n  event.preventDefault();\n  await this.createSchool(this.state.address,this.state.schoolName)\n}\n\n \n\n          render() {\n    return (\n\n      \n      \n        <div>\n\n<p>Account : {this.state.account}</p>\n\n<p>SchoolCount : {this.state.schoolCount}</p>\n\n<p>Contract address: {this.getDiplomaStorageAddress()}</p>\n\n\n<form>\n        <label>\n          adresse :\n          <input\n            placeholder= 'Enter adresse here'\n            name=\"adress\"\n            type=\"text\"\n            //value={this.state.INE}\n            onChange={this.onChange} />\n        </label>\n        <br />\n        <label>\n          schoolName :\n          <input\n            placeholder='School Name'\n            name=\"schoolName\"\n            type=\"text\"\n            //value={this.state.firstName}\n            onChange={this.onChange} />\n        </label>\n        \n      </form>\n\n      <Button\n          type='submit'\n          onClick={this.onSubmit}\n          >\n          Submit\n      </Button>\n\n          \n        \n\n        <p>adress: {this.state.adress}</p>\n        <p>schoolName: {this.state.schoolName}</p>\n        \n        </div>\n    );\n  }\n}\n\nexport default CreateSchool;"]},"metadata":{},"sourceType":"module"}